- secret:
    name: project2-oidc-secret0
    oidc:
      ttl: 300
      algorithm: RS256
      claims:
        aud: sts.amazonaws.com
        my_claim: my_claim_value
        # Test it should not overwrite default claims
        sub: some_sub_value

- secret:
    name: project2-oidc-secret1
    oidc:
      ttl: 300
      algorithm: RS256
      claims:
        aud: sts.amazonaws.com
        my_claim: my_claim_value
        # Test it should not overwrite default claims
        sub: some_sub_value

- secret:
    name: project2-oidc-secret2
    oidc:
      ttl: 300
      algorithm: RS256
      claims:
        aud: sts.amazonaws.com
        my_claim: my_claim_value
        # Test it should not overwrite default claims
        sub: some_sub_value

- job:
    parent: base
    name: project2-dependent-with-return
    run: playbooks/secret.yaml

- job:
    parent: base
    name: project2-parent
    pre-run: playbooks/parent.yaml
    post-run: playbooks/parent.yaml

- job:
    parent: project2-parent
    name: project2-oidc-secret
    run: playbooks/secret.yaml
    vars:
      login_secret0: login_secret0_value
    secrets:
      - secret: project2-oidc-secret0
        name: login_secret0 # Should override job var with same name
      - secret: project2-oidc-secret1
        name: login_secret1 # Should override zuul_return with same name
        pass-to-parent: true # And should be available in parent job
      - secret: project2-oidc-secret2
        name: login_secret2
        pass-to-parent: true # Should be available in parent job

- project:
    check:
      jobs:
        - project2-dependent-with-return
        - project2-oidc-secret:
            dependencies:
              - project2-dependent-with-return
    gate:
      jobs:
        - noop

- secret:
    name: oidc-secret
    oidc:
      ttl: 300
      algorithm: RS256
      claims:
        aud: sts.amazonaws.com
        my_claim: my_claim_value
        # Test it should not overwrite default claims
        sub: some_sub_value

- secret:
    name: oidc-secret-iss-override-allowed
    oidc:
      ttl: 300
      algorithm: RS256
      iss: https://zuul.allowed.com
      claims:
        aud: sts.amazonaws.com
        my_claim: my_claim_value
        # Test it should not overwrite default claims
        sub: some_sub_value

- job:
    parent: base
    name: project2-oidc-secret
    run: playbooks/secret.yaml
    secrets:
      - name: oidc_secret
        secret: oidc-secret
      - name: oidc_secret_iss_override_allowed
        secret: oidc-secret-iss-override-allowed

- project:
    check:
      jobs:
        - project2-oidc-secret
    gate:
      jobs:
        - noop
